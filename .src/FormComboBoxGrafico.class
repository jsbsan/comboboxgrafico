' Gambas class file

Public elegido As String
Public lista As String[]
Public lista2 As String[]
Public origen As Variant

Public Sub Form_Open()

    Me.Arrangement = Arrange.Vertical
    HPanel1.Expand = True
    HPanel1.Spacing = True

End

Public Sub abrir(procede As Variant)

    Dim contenedor As Control = HPanel1
    Dim contenedor2 As Control = HPanel2
    Dim btmp As Button

    Dim l As String

    origen = procede
    For Each l In lista
        btmp = New Button(contenedor) As "obs"

        'icono
        btmp.h = 45
        btmp.w = 90

        If IsNull(Picture["iconos/" & l & ".png"]) Then
            btmp.Text = l
        Else
            btmp.Picture = Picture["iconos/" & l & ".png"]
        Endif

        btmp.Tag = l

    Next

    'listado 2:
    If IsNull(lista2) Then
        'no hacer nada
        HPanel2.visible = False

        Separator2.visible = False
    Else
        HPanel2.visible = True

        Separator2.visible = True

        For Each l In lista2
            btmp = New Button(contenedor2) As "obs"

            'icono
            btmp.h = 45
            btmp.w = 90

            If IsNull(Picture["iconos/" & l & ".png"]) Then
                btmp.Text = l
            Else
                btmp.Picture = Picture["iconos/" & l & ".png"]
            Endif

            btmp.Tag = l

        Next
    Endif

    Me.Show()

End

Public Sub Obs_click()

    elegido = Last.tag
    Label1.text = elegido

End

Public Sub ButtonAceptar_Click()

    origen.text = elegido
    Me.Close()

End

Public Sub ButtonCancelar_Click()

    Me.Close()

End
